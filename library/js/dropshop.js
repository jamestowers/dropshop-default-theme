// Generated by CoffeeScript 1.7.1
(function() {
  this.Dropshop = (function() {
    function Dropshop() {
      console.log('[Dropshop] Initialising...');
      this.$doc = $(document);
      this.$body = $('body');
      this.init();
    }

    Dropshop.prototype.init = function() {
      FastClick.attach(document.body);
      this.setWidths();
      return this.onPageLoad();

      /*
      Add Test for ios and Android
      Modernizr.addTest 'ios', ->
        return !!navigator.userAgent.match(/(iPad|iPhone|iPod)/g)
      Modernizr.addTest 'android', ->
        return !!navigator.userAgent.match(/(android)/g)
       */
    };

    Dropshop.prototype.onPageLoad = function() {
      console.log('[Dropshop] onPageLoad');
      picturefill();
      this.setEventListeners();
      return this.$allMods = $("[data-animate]");
    };

    Dropshop.prototype.setWidths = function() {
      console.log('[Dropshop] setting page dims');
      this.sizes = {
        windowWidth: $(window).width(),
        windowHeight: $(window).height(),
        headerHeight: $('header.header').outerHeight()
      };
      return this.isMobile = this.sizes.windowWidth < 580;
    };

    Dropshop.prototype.onScroll = function() {
      window.ticking = false;
      if (!dropshop.isMobile) {
        if (window.latestKnownScrollY > dropshop.sizes.headerHeight) {
          dropshop.$body.addClass('scrolled');
        } else {
          dropshop.$body.removeClass('scrolled');
        }
      }
      dropshop.$allMods.each(function(i, el) {
        el = $(el);
        if (el.visible(true)) {
          return el.addClass('animate');
        }
      });
    };

    Dropshop.prototype.setEventListeners = function() {
      console.log('[Dropshop] setting event listeners');
      return this.$doc.on('click', 'a#menu-toggle', function() {
        dropshop.$body.toggleClass('slide-from-right');
        return false;
      });
    };

    return Dropshop;

  })();

}).call(this);
